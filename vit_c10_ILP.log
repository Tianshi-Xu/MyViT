2024-04-12 09:34:00,945 - train - INFO - Model vit_7_4_32 created, param count:3717072
2024-04-12 09:34:01,203 - train - INFO - Using native Torch AMP. Training in mixed precision.
2024-04-12 09:34:01,203 - train - INFO - Scheduled epochs: 11
2024-04-12 09:34:02,320 - train - INFO - Verifying initial model
2024-04-12 09:34:02,722 - train - INFO - Test: [   0/39]  Time: 0.400 (0.400)  Loss:  0.4856 (0.4856)  Acc@1: 88.6719 (88.6719)  Acc@5: 99.6094 (99.6094)
2024-04-12 09:34:03,374 - train - INFO - Test: [  39/39]  Time: 0.055 (0.026)  Loss:  0.4690 (0.4492)  Acc@1: 93.7500 (90.9600)  Acc@5: 100.0000 (99.5200)
2024-04-12 09:34:03,460 - train - INFO - ViTLite(
  (tokenizer): Tokenizer(
    (conv_layers): Sequential(
      (0): Sequential(
        (0): Conv2d(3, 256, kernel_size=(4, 4), stride=(4, 4))
        (1): Identity()
        (2): Identity()
      )
    )
    (flattener): Flatten(start_dim=2, end_dim=3)
  )
  (classifier): TransformerClassifier(
    (dropout): Dropout(p=0.0, inplace=False)
    (blocks): ModuleList(
      (0): TransformerEncoderLayer(
        (pre_norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (self_attn): Attention(
          (qkv): CirLinear(in_features=256, out_features=768, bias=False, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
          (attn_drop): Dropout(p=0.1, inplace=False)
          (proj): CirLinear(in_features=256, out_features=256, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
          (proj_drop): Dropout(p=0.0, inplace=False)
        )
        (linear1): CirLinear(in_features=256, out_features=512, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
        (dropout1): Dropout(p=0.0, inplace=False)
        (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (linear2): CirLinear(in_features=512, out_features=256, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
        (dropout2): Dropout(p=0.0, inplace=False)
        (drop_path): Identity()
        (activation): ReLU()
      )
      (1-6): 6 x TransformerEncoderLayer(
        (pre_norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (self_attn): Attention(
          (qkv): CirLinear(in_features=256, out_features=768, bias=False, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
          (attn_drop): Dropout(p=0.1, inplace=False)
          (proj): CirLinear(in_features=256, out_features=256, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
          (proj_drop): Dropout(p=0.0, inplace=False)
        )
        (linear1): CirLinear(in_features=256, out_features=512, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
        (dropout1): Dropout(p=0.0, inplace=False)
        (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (linear2): CirLinear(in_features=512, out_features=256, bias=True, fix_block_size=1, search_space=[1, 2, 4, 8, 16, 32, 64])
        (dropout2): Dropout(p=0.0, inplace=False)
        (drop_path): DropPath()
        (activation): ReLU()
      )
    )
    (norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (fc): CirLinear(in_features=256, out_features=10, bias=True, fix_block_size=1, search_space=[1, 2])
  )
)
2024-04-12 09:34:09,521 - train - INFO - len trace:30
2024-04-12 09:34:10,286 - train - INFO - cir_idx:[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2024-04-12 09:34:10,287 - train - INFO - len traces:(30,)
2024-04-12 09:34:10,287 - train - INFO - traces:[2.54649599e-02 4.47507093e-05 1.42147513e-04 4.75160241e-04
 4.23290395e-04 3.17774582e-05 2.15208089e-04 3.61804340e-04
 8.86025414e-05 1.12281413e-04 2.19557684e-04 3.44711028e-04
 6.88423548e-05 1.17214323e-04 2.14172198e-04 2.79219201e-04
 3.06784270e-05 1.14319610e-04 1.59297770e-04 2.84775746e-04
 3.74954178e-05 7.98853906e-05 1.53165428e-04 2.20421820e-04
 8.05534394e-05 8.04959509e-05 1.47033524e-04 3.45296127e-04
 7.45469298e-04 2.43129206e-02]
2024-04-12 09:34:10,288 - train - INFO - len params:29
2024-04-12 09:34:10,288 - train - INFO - params[0].shape:torch.Size([768, 256])
2024-04-12 09:34:10,288 - train - INFO - delta_weights_b2:[768.6538696289062, 68.92146301269531, 3076.501708984375, 1037.3739013671875, 1346.16162109375, 463.65325927734375, 2767.26611328125, 468.95208740234375, 1615.1453857421875, 455.0174255371094, 3142.864501953125, 362.448974609375, 1542.60302734375, 412.576904296875, 3776.779296875, 307.2396240234375, 1479.9876708984375, 358.66973876953125, 4300.60595703125, 287.51580810546875, 1361.139892578125, 369.69573974609375, 3491.53173828125, 518.209228515625, 1205.429443359375, 561.3876953125, 1357.5233154296875, 1218.000732421875, 27.756511688232422]
2024-04-12 09:34:10,288 - train - INFO - delta_weights_b4:[1105.25830078125, 99.45111846923828, 4353.2900390625, 1360.1348876953125, 1874.4110107421875, 646.6024780273438, 3957.785888671875, 598.8999633789062, 2221.140869140625, 621.1547241210938, 4568.8408203125, 450.840576171875, 2093.13671875, 548.0089721679688, 5273.7666015625, 382.9873962402344, 1979.16064453125, 488.3177795410156, 5792.1728515625, 353.1305847167969, 1810.7984619140625, 485.747802734375, 4635.34814453125, 648.2232055664062, 1572.188232421875, 771.627197265625, 1807.2275390625, 1395.2718505859375, 27.756511688232422]
2024-04-12 09:34:10,288 - train - INFO - delta_weights_b8:[1272.77099609375, 114.53639221191406, 5107.15283203125, 1518.3387451171875, 2127.11962890625, 739.60791015625, 4586.79150390625, 652.814697265625, 2525.370361328125, 698.5040283203125, 5160.58740234375, 490.5881652832031, 2362.727294921875, 621.2984008789062, 5894.7001953125, 415.600830078125, 2209.221435546875, 552.5626220703125, 6577.7470703125, 379.15704345703125, 2017.6925048828125, 542.8623046875, 5406.76318359375, 687.325927734375, 1741.0546875, 890.1864624023438, 2037.025634765625, 1491.1590576171875, 27.756511688232422]
2024-04-12 09:34:10,288 - train - INFO - delta_weights_b16:[1353.948486328125, 121.69397735595703, 5324.494140625, 1600.2027587890625, 2256.4287109375, 786.6505126953125, 4722.81494140625, 679.2179565429688, 2687.92578125, 741.1148071289062, 5334.00634765625, 505.2562561035156, 2490.763427734375, 656.8915405273438, 6123.61181640625, 432.0520324707031, 2326.385986328125, 591.024658203125, 6971.69873046875, 393.4623107910156, 2119.454345703125, 575.1746215820312, 5703.99365234375, 704.7139282226562, 1828.2994384765625, 943.9135131835938, 2140.892578125, 1529.647705078125, 27.756511688232422]
2024-04-12 09:34:10,288 - train - INFO - delta_weights_b32:[]
2024-04-12 09:34:10,346 - train - INFO - result:[16 16  2 16 16 16  2 16 16 16  2 16 16 16  2 16 16 16  2 16 16 16  2 16
 16 16  8 16  2]
2024-04-12 09:34:10,348 - train - INFO - ratio:tensor(0.1993)
2024-04-12 09:39:50,893 - train - INFO - Model vit_7_4_32 created, param count:3717072
2024-04-12 09:39:51,108 - train - INFO - Using native Torch AMP. Training in mixed precision.
2024-04-12 09:39:51,108 - train - INFO - Scheduled epochs: 11
2024-04-12 09:39:52,305 - train - INFO - Verifying initial model
2024-04-12 09:39:52,749 - train - INFO - Test: [   0/39]  Time: 0.443 (0.443)  Loss:  0.4856 (0.4856)  Acc@1: 88.6719 (88.6719)  Acc@5: 99.6094 (99.6094)
2024-04-12 09:39:53,432 - train - INFO - Test: [  39/39]  Time: 0.071 (0.028)  Loss:  0.4690 (0.4492)  Acc@1: 93.7500 (90.9600)  Acc@5: 100.0000 (99.5200)
2024-04-12 09:39:59,591 - train - INFO - len trace:30
2024-04-12 09:40:00,349 - train - INFO - cir_idx:[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2024-04-12 09:40:00,349 - train - INFO - len traces:(30,)
2024-04-12 09:40:00,350 - train - INFO - traces:[2.54649599e-02 4.47507093e-05 1.42147513e-04 4.75160241e-04
 4.23290395e-04 3.17774582e-05 2.15208089e-04 3.61804340e-04
 8.86025414e-05 1.12281413e-04 2.19557684e-04 3.44711028e-04
 6.88423548e-05 1.17214323e-04 2.14172198e-04 2.79219201e-04
 3.06784270e-05 1.14319610e-04 1.59297770e-04 2.84775746e-04
 3.74954178e-05 7.98853906e-05 1.53165428e-04 2.20421820e-04
 8.05534394e-05 8.04959509e-05 1.47033524e-04 3.45296127e-04
 7.45469298e-04 2.43129206e-02]
2024-04-12 09:40:00,350 - train - INFO - len params:29
2024-04-12 09:40:00,350 - train - INFO - params[0].shape:torch.Size([768, 256])
2024-04-12 09:40:00,350 - train - INFO - delta_weights_b2:[768.6538696289062, 68.92146301269531, 3076.501708984375, 1037.3739013671875, 1346.16162109375, 463.65325927734375, 2767.26611328125, 468.95208740234375, 1615.1453857421875, 455.0174255371094, 3142.864501953125, 362.448974609375, 1542.60302734375, 412.576904296875, 3776.779296875, 307.2396240234375, 1479.9876708984375, 358.66973876953125, 4300.60595703125, 287.51580810546875, 1361.139892578125, 369.69573974609375, 3491.53173828125, 518.209228515625, 1205.429443359375, 561.3876953125, 1357.5233154296875, 1218.000732421875, 27.756511688232422]
2024-04-12 09:40:00,350 - train - INFO - delta_weights_b4:[1105.25830078125, 99.45111846923828, 4353.2900390625, 1360.1348876953125, 1874.4110107421875, 646.6024780273438, 3957.785888671875, 598.8999633789062, 2221.140869140625, 621.1547241210938, 4568.8408203125, 450.840576171875, 2093.13671875, 548.0089721679688, 5273.7666015625, 382.9873962402344, 1979.16064453125, 488.3177795410156, 5792.1728515625, 353.1305847167969, 1810.7984619140625, 485.747802734375, 4635.34814453125, 648.2232055664062, 1572.188232421875, 771.627197265625, 1807.2275390625, 1395.2718505859375, 27.756511688232422]
2024-04-12 09:40:00,350 - train - INFO - delta_weights_b8:[1272.77099609375, 114.53639221191406, 5107.15283203125, 1518.3387451171875, 2127.11962890625, 739.60791015625, 4586.79150390625, 652.814697265625, 2525.370361328125, 698.5040283203125, 5160.58740234375, 490.5881652832031, 2362.727294921875, 621.2984008789062, 5894.7001953125, 415.600830078125, 2209.221435546875, 552.5626220703125, 6577.7470703125, 379.15704345703125, 2017.6925048828125, 542.8623046875, 5406.76318359375, 687.325927734375, 1741.0546875, 890.1864624023438, 2037.025634765625, 1491.1590576171875, 27.756511688232422]
2024-04-12 09:40:00,350 - train - INFO - delta_weights_b16:[1353.948486328125, 121.69397735595703, 5324.494140625, 1600.2027587890625, 2256.4287109375, 786.6505126953125, 4722.81494140625, 679.2179565429688, 2687.92578125, 741.1148071289062, 5334.00634765625, 505.2562561035156, 2490.763427734375, 656.8915405273438, 6123.61181640625, 432.0520324707031, 2326.385986328125, 591.024658203125, 6971.69873046875, 393.4623107910156, 2119.454345703125, 575.1746215820312, 5703.99365234375, 704.7139282226562, 1828.2994384765625, 943.9135131835938, 2140.892578125, 1529.647705078125, 27.756511688232422]
2024-04-12 09:40:00,350 - train - INFO - delta_weights_b32:[]
2024-04-12 09:40:00,426 - train - INFO - result:[16 16  2 16 16 16 16 16 16 16  2 16 16 16 16 16 16 16  2 16 16 16  8 16
 16 16 16 16  2]
2024-04-12 09:40:00,428 - train - INFO - ratio:tensor(0.1496)
